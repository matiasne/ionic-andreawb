<ion-header class="ion-no-border">
  <ion-toolbar>
    <app-header [titulo]="'Policy Registration'" [icono]="'close'" (click)='clickIcono($event)'></app-header>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">  
  
  <form [formGroup]="datosForm" (ngSubmit)="registrar()">

    <!--NÃºmero-->
    <ion-item [class.invalid]="submitted && !datosForm.controls.number.valid" >
      <ion-icon name="checkmark-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">Number</ion-label>     
      <ion-input name="number" type="text" formControlName="number" required ></ion-input>
      <div *ngIf="submitted && f.number.errors" class="invalid-feedback">
        <div *ngIf="f.number.errors.required">
          <h5>Enter a policy number</h5>
        </div>
      </div>
    </ion-item>

    

    <!--Fecha  recibido-->
    <ion-item [class.invalid]="submitted && !datosForm.controls.receivedDate.valid" >
      <ion-icon name="calendar-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">Received date</ion-label>     
      <ion-datetime displayFormat="MM/DD/YYYY" min="2000-01-01" max="2100-12-31" 
                    formControlName="receivedDate" name="receireceivedDatevedDate" required></ion-datetime>
      <div *ngIf="submitted && f.receivedDate.errors" class="invalid-feedback">
        <div *ngIf="f.receivedDate.errors.required">
          <h5>Select a date</h5>
        </div>
      </div>
    </ion-item>

    <!--Fecha  efectiva-->
    <ion-item [class.invalid]="submitted && !datosForm.controls.effectiveDate.valid" >
      <ion-icon name="calendar-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">Effective date</ion-label>     
      <ion-datetime displayFormat="MM/DD/YYYY" min="2000-01-01" max="2100-12-31" 
                    formControlName="effectiveDate" name="effectiveDate" required></ion-datetime>
      <div *ngIf="submitted && f.effectiveDate.errors" class="invalid-feedback">
        <div *ngIf="f.effectiveDate.errors.required">
          <h5>Select a date</h5>
        </div>
      </div>
    </ion-item>

    <!--Fecha de pagado-->
    <ion-item [class.invalid]="submitted && !datosForm.controls.paidThroughDate.valid" >
      <ion-icon name="calendar-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">Paid through date</ion-label>     
      <ion-datetime displayFormat="MM/DD/YYYY" min="2000-01-01" max="2100-12-31" 
                    formControlName="paidThroughDate" name="paidThroughDate" required></ion-datetime>
      <div *ngIf="submitted && f.paidThroughDate.errors" class="invalid-feedback">
        <div *ngIf="f.paidThroughDate.errors.required">
          <h5>Select a date</h5>
        </div>
      </div>
    </ion-item>
    <!--Fecha de pagado-->
    <ion-item [class.invalid]="submitted && !datosForm.controls.policyTermDate.valid" >
      <ion-icon name="calendar-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">Term Date</ion-label>     
      <ion-datetime displayFormat="MM/DD/YYYY" min="2000-01-01" max="2100-12-31" 
                    formControlName="policyTermDate" name="policyTermDate" required></ion-datetime>
      <div *ngIf="submitted && f.policyTermDate.errors" class="invalid-feedback">
        <div *ngIf="f.policyTermDate.errors.required">
          <h5>Select a date</h5>
        </div>
      </div>
    </ion-item>
     <!--estado-->
     <ion-item [class.invalid]="submitted && !datosForm.controls.state.valid" >
      <ion-icon name="map-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">State</ion-label>     
      <ion-input name="state" type="text" formControlName="state" required ></ion-input>
      <div *ngIf="submitted && f.state.errors" class="invalid-feedback">
        <div *ngIf="f.state.errors.required">
          <h5>Enter a state</h5>
        </div>
      </div>
    </ion-item>

    <!--responsabilidad-->
    <ion-item [class.invalid]="submitted && !datosForm.controls.responsability.valid" >
      <ion-icon name="newspaper-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">Responsability</ion-label>     
      <ion-input name="responsability" type="text" formControlName="responsability" required ></ion-input>
      <div *ngIf="submitted && f.responsability.errors" class="invalid-feedback">
        <div *ngIf="f.responsability.errors.required">
          <h5>Enter a responsability</h5>
        </div>
      </div>
    </ion-item>

    <!--autoplay-->
    <ion-item [class.invalid]="submitted && !datosForm.controls.autoplay.valid" >
      <ion-icon name="checkbox-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">Autoplay</ion-label>     
      <ion-select placeholder="Select one" formControlName="autoplay" name="autoplay">
        <ion-select-option>True</ion-select-option>
        <ion-select-option>False</ion-select-option>
      </ion-select>
      <div *ngIf="submitted && f.autoplay.errors" class="invalid-feedback">
        <div *ngIf="f.autoplay.errors.required">
          <h5>Select one</h5>
        </div>
      </div>
    </ion-item>

    <!--elegibleForCommission-->
    <ion-item [class.invalid]="submitted && !datosForm.controls.elegibleForCommission.valid" >
      <ion-icon name="checkbox-outline" slot="start" color="primary"></ion-icon>
      <ion-label position="floating">Elegible for commission</ion-label>     
      <ion-select placeholder="Select one" formControlName="elegibleForCommission" name="elegibleForCommission">
        <ion-select-option>True</ion-select-option>
        <ion-select-option>False</ion-select-option>
      </ion-select>
      <div *ngIf="submitted && f.elegibleForCommission.errors" class="invalid-feedback">
        <div *ngIf="f.elegibleForCommission.errors.required">
          <h5>Select one</h5>
        </div>
      </div>
    </ion-item>

    <ion-item [class.invalid]="submitted && !datosForm.controls.clientRef.valid">
      <ion-label>Client</ion-label>     
      <ion-button slot="end" color="primary" (click)="addClient()">+</ion-button>
      <div *ngIf="submitted && f.clientRef.errors" class="invalid-feedback">
        <div *ngIf="f.clientRef.errors.required">
          <h5>Enter a client</h5>
        </div>
      </div>
    </ion-item>     
    <ion-item *ngIf="client.id">
      <ion-icon name="person-outline" slot="start" color="primary"></ion-icon>
      {{client.firstName}} {{client.lastName}}
      <ion-icon name="trash-outline" slot="end" color="primary" (click)="deleteClient()"></ion-icon>
    </ion-item>

    <!--Clientes miembros-->
    <ion-item>
      <ion-label>Family's members</ion-label>     
      <ion-button slot="end" color="primary" (click)="addFamily()">+</ion-button>
    </ion-item>

    <ion-item *ngFor="let miembro of familyMembers;let i= index">
      <ion-icon name="person-outline" slot="start" color="primary"></ion-icon>
      {{miembro.firstName}} {{miembro.lastName}} 
      <ion-icon name="trash-outline" slot="end" color="primary"  (click)="deleteFamily(i)"></ion-icon>
    </ion-item>


    <ion-button type="submit" expand="block">Submit</ion-button>    
  </form>
</ion-content>